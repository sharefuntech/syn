function shadeColor(color, percent) {

    var R = parseInt(color.substring(1,3),16)
    var G = parseInt(color.substring(3,5),16)
    var B = parseInt(color.substring(5,7),16);

    R = parseInt(R * (100 + percent) / 100);
    G = parseInt(G * (100 + percent) / 100);
    B = parseInt(B * (100 + percent) / 100);

    R = (R<255)?R:255;
    G = (G<255)?G:255;
    B = (B<255)?B:255;

    var RR = ((R.toString(16).length==1)?"0"+R.toString(16):R.toString(16));
    var GG = ((G.toString(16).length==1)?"0"+G.toString(16):G.toString(16));
    var BB = ((B.toString(16).length==1)?"0"+B.toString(16):B.toString(16));

    return "#"+RR+GG+BB;
}

function gradient(baseColor)
{
  var gradientId = "gradient" + baseColor.substring(1)

  //var lightColor = shadeColor(baseColor, -10)
  var darkColor = shadeColor(baseColor, -20)

  var grad = d3.select("#gradients").selectAll("#" + gradientId)
    .data([ gradientId ])
    .enter()
    .append("radialGradient")
    .attr("id", gradientId)
    .attr("gradientUnits", "objectBoundingBox")
    .attr("fx", "30%")
    .attr("fy", "30%")

  grad.append("stop")
    .attr("offset", "0%")
    .attr("style", "stop-color:#FFFFFF")

  // Middle
  grad.append("stop")
    .attr("offset", "40%")
    .attr("style", "stop-color:" + baseColor)

  // Outer Edges
  grad.append("stop")
    .attr("offset", "100%")
    .attr("style", "stop-color:" + darkColor)

  return "url(#" + gradientId + ")";
}

  var jsonData = [
                  {"name":"United States","category":"America","x":[[1950,15855.86],[1951,16750.74],[1952,17039.38],[1953,17471.28],[1954,16979.26],[1955,17822.45],[1956,17783.27],[1957,17749.5],[1958,17217.39],[1959,18084.11],[1960,18175.43],[1961,18226.62],[1962,18978.45],[1963,19461.1],[1964,20243.98],[1965,21209.93],[1966,22263.22],[1967,22495.68],[1968,23268.21],[1969,23669.41],[1970,23345.77],[1971,23744.67],[1972,24654.04],[1973,25742],[1974,25281.7],[1975,24889.6],[1976,25881.72],[1977,26715.14],[1978,27814.18],[1979,28278.91],[1980,27838.11],[1981,28160.14],[1982,27243.47],[1983,28119.69],[1984,29785.25],[1985,30636.21],[1986,31297.31],[1987,31953.81],[1988,32860.52],[1989,33587.09],[1990,33710.39],[1991,33076.87],[1992,33589.59],[1993,33914.89],[1994,34730.56],[1995,35053.29],[1996,35807],[1997,36847.81],[1998,37811.68],[1999,38912.58],[2000,39758.5],[2001,39474.11],[2002,39535.84],[2003,40044.18],[2004,40956.4],[2005,41674],[2006,42385.18],[2007,42866.22],[2008,42656.49],[2009,41256.08]], "size":[[1950,152271000],[1951,154878000],[1952,157553000],[1953,160184000],[1954,163026000],[1955,165931000],[1956,168903000],[1957,171984000],[1958,174882000],[1959,177830000],[1960,180671000],[1961,183691000],[1962,186538000],[1963,189242000],[1964,191889000],[1965,194303000],[1966,196560000],[1967,198712000],[1968,200706000],[1969,202677000],[1970,205052000],[1971,207661000],[1972,209896000],[1973,211909000],[1974,213854000],[1975,215973000],[1976,218035000],[1977,220239000],[1978,222585000],[1979,225055000],[1980,227726463],[1981,229966237],[1982,232187835],[1983,234307207],[1984,236348292],[1985,238466283],[1986,240650755],[1987,242803533],[1988,245021414],[1989,247341697],[1990,250131894],[1991,253492503],[1992,256894189],[1993,260255352],[1994,263435673],[1995,266557091],[1996,269667391],[1997,272911760],[1998,276115288],[1999,279294713],[2000,282338631],[2001,285023886],[2002,287675526],[2003,290342554],[2004,293027571],[2005,295734134],[2006,298444215],[2007,301139947],[2008,303824646]],"y":[[1800,39.41],[1880,39.41],[1890,45.21],[1901,49.3],[1902,50.5],[1903,50.6],[1904,49.6],[1905,50.3],[1906,50.1],[1907,50.2],[1908,51.9],[1909,52.8],[1910,51.8],[1911,53.4],[1912,54.1],[1913,53.5],[1914,54.6],[1915,55.1],[1916,54.2],[1917,54],[1918,47.2],[1919,55.3],[1920,55.4],[1921,58.2],[1922,58.1],[1923,57.5],[1924,58.5],[1925,58.5],[1926,57.9],[1927,59.4],[1928,58.3],[1929,58.5],[1930,59.6],[1931,60.3],[1932,61],[1933,60.95],[1934,60.31],[1935,60.97],[1936,60.42],[1937,61.11],[1938,62.44],[1939,63.12],[1940,63.28],[1941,63.84],[1942,64.63],[1943,64.34],[1944,65.13],[1945,65.63],[1946,66.33],[1947,66.73],[1948,67.3],[1949,67.68],[1950,68.12],[1951,68.22],[1952,68.44],[1953,68.79],[1954,69.58],[1955,69.63],[1956,69.71],[1957,69.49],[1958,69.76],[1959,69.98],[1960,69.91],[1961,70.32],[1962,70.21],[1963,70.04],[1964,70.33],[1965,70.41],[1966,70.43],[1967,70.76],[1968,70.42],[1969,70.66],[1970,70.92],[1971,71.24],[1972,71.34],[1973,71.54],[1974,72.08],[1975,72.68],[1976,72.99],[1977,73.38],[1978,73.58],[1979,74.03],[1980,73.93],[1981,74.36],[1982,74.65],[1983,74.71],[1984,74.82],[1985,74.79],[1986,74.87],[1987,75.01],[1988,75.03],[1989,75.31],[1990,75.6],[1991,75.8],[1992,76.08],[1993,75.83],[1994,76],[1995,76.09],[1996,76.44],[1997,76.8],[1998,76.97],[1999,76.97],[2000,77.13],[2001,77.25],[2002,77.31],[2003,77.49],[2004,77.92],[2005,77.93],[2006,78.21],[2007,79.09],[2008,79.27],[2009,79.43]]},
                  {"name":"China","category":"East Asia & Pacific","x":[[1950,394.49],[1951,432.35],[1952,473.38],[1953,486.2],[1954,490.39],[1955,507.64],[1956,542.5],[1957,560],[1958,607.89],[1959,604.38],[1960,583.02],[1961,486.83],[1962,484.67],[1963,519.76],[1964,567.77],[1965,617.76],[1966,657.14],[1967,622.45],[1968,594.27],[1969,627.78],[1970,685.35],[1971,699.98],[1972,702.94],[1973,738.22],[1974,735.36],[1975,767.09],[1976,750.79],[1977,786.85],[1978,861.1],[1979,915.22],[1980,934.27],[1981,977.54],[1982,1044.34],[1983,1107.46],[1984,1229.08],[1985,1337.64],[1986,1406.19],[1987,1529.5],[1988,1611.38],[1989,1615.03],[1990,1647.38],[1991,1732.13],[1992,1877.41],[1993,2035.59],[1994,2214.2],[1995,2521.34],[1996,2546.44],[1997,2653.3],[1998,2635.55],[1999,2784.39],[2000,3012.12],[2001,3309.8],[2002,3695.65],[2003,4228.98],[2004,4551.13],[2005,4909.2],[2006,5450.12],[2007,6127.78],[2008,6679.2],[2009,7226.07]],"size":[[1950,546815000],[1951,557480000],[1952,568910000],[1953,581390000],[1954,595310000],[1955,608655000],[1956,621465000],[1957,637408000],[1958,653235000],[1959,666005000],[1960,667070000],[1961,660330000],[1962,665770000],[1963,682335000],[1964,698355000],[1965,715185000],[1966,735400000],[1967,754550000],[1968,774510000],[1969,796025000],[1970,818315000],[1971,841105000],[1972,862030000],[1973,881940000],[1974,900350000],[1975,916395000],[1976,930685000],[1977,943455000],[1978,956165000],[1979,969005000],[1980,981235000],[1981,993861000],[1982,1000281000],[1983,1023288000],[1984,1036825000],[1985,1051040000],[1986,1066790000],[1987,1084035000],[1988,1101630000],[1989,1118650000],[1990,1135185000],[1991,1150780000],[1992,1164970000],[1993,1178440000],[1994,1191835000],[1995,1204855000],[1996,1217550000],[1997,1230075000],[1998,1241935000],[1999,1252735000],[2000,1262645000],[2001,1271850000],[2002,1280400000],[2003,1288400000],[2004,1295733978],[2005,1303182268],[2006,1310823807],[2007,1318683096],[2008,1326856173]],"y":[[1950,39.25],[1951,39.64],[1952,40.41],[1953,44.56],[1954,46.47],[1955,48.02],[1956,50.45],[1957,50.55],[1958,50.16],[1959,38.4],[1960,31.63],[1961,34.1],[1962,44.5],[1963,51.9],[1964,53.32],[1965,55.65],[1966,56.8],[1967,58.38],[1968,59.41],[1969,60.97],[1970,62.65],[1971,63.74],[1972,63.12],[1973,62.78],[1974,62.5],[1975,62.7],[1976,62.44],[1977,63.97],[1978,64.24],[1979,65.09],[1980,66.12],[1981,66.45],[1982,66.37],[1983,66.54],[1984,66.71],[1985,66.89],[1986,67.08],[1987,67.29],[1988,67.52],[1989,67.77],[1990,68.04],[1991,68.33],[1992,68.64],[1993,68.95],[1994,69.27],[1995,69.6],[1996,69.94],[1997,70.28],[1998,70.62],[1999,70.96],[2000,71.29],[2001,71.59],[2002,71.87],[2003,72.13],[2004,72.35],[2005,72.56],[2006,72.74],[2007,72.92],[2008,73.1],[2009,73.28]]}
                 ];

  var width = 800
  var height = 600
  var topMargin = 40
  var bottomMargin = 50
  var leftMargin = 140
  var rightMargin = 40
  var title = "Time Lapse"
  var xtitle = "X Title"
  var ytitle = "Y Title"
  var title = "New Time Lapse"
  var xaxisscale = "Linear"
  var yaxisscale = "Linear"
  var xFormat = ",d"
  var yFormat = ",d"

  var xMax = 1e5
  var xMin = 300
  var yMax = 85
  var yMin = 10
  var sizeMin = 0
  var sizeMax = 5e8
  var yearMin = 1850
  var yearMax = 2009

jsonData = [{ "name":"Portugal", "category":"Portugal","x": [[1981, 8.48333437922121E+01],[1991, 9.15870587710867E+01]], "y": [[1981, 7.46079898529726E+01],[1991, 8.46582143362115E+01]], "size": [[1981, 9.85136200000000E+06],[1991, 9.96787800000000E+06]] },{ "name":"Belarus", "category":"Belarus","x": [[1989, 9.93841831991060E+01],[1999, 9.97921146412421E+01]], "y": [[1989, 9.66282207366457E+01],[1999, 9.94197193788276E+01]], "size": [[1989, 1.01700000000000E+07],[1999, 1.00350000000000E+07]] },{ "name":"Philippines", "category":"Philippines","x": [[1980, 8.38892925846678E+01],[1990, 9.39716890331536E+01],[2000, 9.25450017099845E+01],[2003, 9.16344871164783E+01],[2008, 9.50121343696050E+01]], "y": [[1980, 8.27621475490498E+01],[1990, 9.31807245517549E+01],[2000, 9.26549065059997E+01],[2003, 9.35645334286736E+01],[2008, 9.58256325572255E+01]], "size": [[1980, 4.70639230000000E+07],[1990, 6.16286680000000E+07],[2000, 7.73099650000000E+07],[2003, 8.22939900000000E+07],[2008, 9.01731390000000E+07]] },{ "name":"Tanzania", "category":"Tanzania","x": [[1988, 7.13657099033929E+01],[2002, 7.75063997558865E+01]], "y": [[1988, 4.80880241442114E+01],[2002, 6.21723175913020E+01]], "size": [[1988, 2.39286580000000E+07],[2002, 3.58324940000000E+07]] },{ "name":"Morocco", "category":"Morocco","x": [[1982, 4.37143940996769E+01],[1994, 5.51551666794586E+01],[2004, 6.57067566674753E+01],[2008, 6.83658568326999E+01]], "y": [[1982, 1.75148667619040E+01],[1994, 2.87254187909687E+01],[2004, 3.96195564879240E+01],[2008, 4.25878481681817E+01]], "size": [[1982, 2.06330040000000E+07],[1994, 2.65236000000000E+07],[2004, 3.00821520000000E+07],[2008, 3.13214530000000E+07]] },{ "name":"Mali", "category":"Mali","x": [[1976, 1.35129169925858E+01],[1998, 2.67329703067045E+01],[2003, 3.27000000000000E+01],[2006, 3.48578910447601E+01]], "y": [[1976, 5.73528116870122E+00],[1998, 1.18934284268737E+01],[2003, 1.59000000000000E+01],[2006, 1.81909125312057E+01]], "size": [[1976, 6.72577600000000E+06],[1998, 1.06625170000000E+07],[2003, 1.23801040000000E+07],[2006, 1.35927960000000E+07]] },{ "name":"Ecuador", "category":"Ecuador","x": [[1982, 8.67869666463128E+01],[1990, 9.04967721381718E+01],[2001, 9.23271296605998E+01],[2007, 8.72593639003152E+01]], "y": [[1982, 8.04052269910437E+01],[1990, 8.61933332935725E+01],[2001, 8.96970869415688E+01],[2007, 8.16805872987492E+01]], "size": [[1982, 8.40303400000000E+06],[1990, 1.02605870000000E+07],[2001, 1.25520360000000E+07],[2007, 1.38497210000000E+07]] },{ "name":"Indonesia", "category":"Indonesia","x": [[1980, 7.74749979969158E+01],[1990, 8.80245210716949E+01],[2004, 9.40350822735704E+01],[2006, 9.51585438828547E+01],[2008, 9.53831934832699E+01]], "y": [[1980, 5.76946277682660E+01],[1990, 7.52701186944656E+01],[2004, 8.67995890698538E+01],[2006, 8.87869838386071E+01],[2008, 8.91013908702289E+01]], "size": [[1980, 1.50820044000000E+08],[1990, 1.84345939000000E+08],[2004, 2.24606531000000E+08],[2006, 2.29918547000000E+08],[2008, 2.34951154000000E+08]] },{ "name":"Nicaragua", "category":"Nicaragua","x": [[2001, 7.67604871722247E+01],[2005, 7.80964265954624E+01]], "y": [[2001, 7.66016564327620E+01],[2005, 7.79160420150301E+01]], "size": [[2001, 5.14863500000000E+06],[2005, 5.42433600000000E+06]] },{ "name":"Afghanistan", "category":"Afghanistan","x": [[1979, 3.03077476688153E+01]], "y": [[1979, 4.98746044198543E+00]], "size": [[1979, 1.49254688145007E+07]] },{ "name":"Chile", "category":"Chile","x": [[1982, 9.14805436891526E+01],[1992, 9.45630729748501E+01],[2002, 9.57964073127151E+01],[2008, 9.86016356826989E+01]], "y": [[1982, 9.08001205168330E+01],[1992, 9.40367135558045E+01],[2002, 9.56409266938754E+01],[2008, 9.86955727595277E+01]], "size": [[1982, 1.15272740000000E+07],[1992, 1.36783730000000E+07],[2002, 1.57839910000000E+07],[2008, 1.67955930000000E+07]] },{ "name":"Kyrgyz Republic", "category":"Kyrgyz Republic","x": [[1999, 9.93067074702720E+01]], "y": [[1999, 9.81306271888534E+01]], "size": [[1999, 4.84030000000000E+06]] },{ "name":"Lao PDR", "category":"Lao PDR","x": [[1995, 7.34862456097611E+01],[2000, 8.13601772468934E+01],[2001, 7.70060601848634E+01],[2005, 8.24517451596179E+01]], "y": [[1995, 4.79023617751578E+01],[2000, 5.84606986899563E+01],[2001, 6.09025202342568E+01],[2005, 6.32269856999142E+01]], "size": [[1995, 4.79511200000000E+06],[2000, 5.31706000000000E+06],[2001, 5.40891200000000E+06],[2005, 5.75334100000000E+06]] },{ "name":"Haiti", "category":"Haiti","x": [[1982, 3.71297408737312E+01],[2006, 5.33550480672341E+01]], "y": [[1982, 3.25249563900814E+01],[2006, 4.45994542866971E+01]], "size": [[1982, 5.95792000000000E+06],[2006, 9.47913600000000E+06]] },{ "name":"Bahrain", "category":"Bahrain","x": [[1981, 7.65183733932241E+01],[1991, 8.85373733928352E+01],[2001, 8.85541074994749E+01]], "y": [[1981, 5.85910923877537E+01],[1991, 7.69323187825390E+01],[2001, 8.35574176145113E+01]], "size": [[1981, 3.72074000000000E+05],[1991, 5.06685000000000E+05],[2001, 6.42510000000000E+05]] },{ "name":"Puerto Rico", "category":"Puerto Rico","x": [[1980, 8.77480320455713E+01],[1990, 8.95026898926341E+01],[2004, 9.00000000000000E+01]], "y": [[1980, 8.58503385445606E+01],[1990, 8.97309612580349E+01],[2004, 9.07000000000000E+01]], "size": [[1980, 3.20600000000000E+06],[1990, 3.53700000000000E+06],[2004, 3.89393100000000E+06]] },{ "name":"Cape Verde", "category":"Cape Verde","x": [[1990, 7.47592660420383E+01],[2004, 8.75000000000000E+01]], "y": [[1990, 5.29986160977829E+01],[2004, 7.51000000000000E+01]], "size": [[1990, 3.48165000000000E+05],[2004, 4.66784000000000E+05]] },{ "name":"Sierra Leone", "category":"Sierra Leone","x": [[2004, 4.66542949771337E+01]], "y": [[2004, 2.41589269429493E+01]], "size": [[2004, 4.95213400000000E+06]] },{ "name":"Latvia", "category":"Latvia","x": [[1989, 9.97545425969330E+01],[2000, 9.97933406909727E+01]], "y": [[1989, 9.92025507220102E+01],[2000, 9.97097311734486E+01]], "size": [[1989, 2.66695500000000E+06],[2000, 2.37298500000000E+06]] },{ "name":"Cayman Islands", "category":"Cayman Islands","x": [[2007, 9.87223937307053E+01]], "y": [[2007, 9.90214773183460E+01]], "size": [[2007, 5.46790000000000E+04]] },{ "name":"Bangladesh", "category":"Bangladesh","x": [[1981, 3.97323009869234E+01],[1991, 4.43142828403874E+01],[2001, 5.38960920251071E+01]], "y": [[1981, 1.79716294005283E+01],[1991, 2.58389798798108E+01],[2001, 4.08233499617312E+01]], "size": [[1981, 8.28836160000000E+07],[1991, 1.07768749000000E+08],[2001, 1.31944584000000E+08]] },{ "name":"Bosnia and Herzegovina", "category":"Bosnia and Herzegovina","x": [[2000, 9.90337078651685E+01]], "y": [[2000, 9.43599446910705E+01]], "size": [[2000, 3.69369800000000E+06]] },{ "name":"Panama", "category":"Panama","x": [[1980, 8.80965169921868E+01],[1990, 8.93369625538437E+01],[2000, 9.25479271706357E+01]], "y": [[1980, 8.80465280307552E+01],[1990, 8.82148461527122E+01],[2000, 9.12471788013040E+01]], "size": [[1980, 1.95302900000000E+06],[1990, 2.41592600000000E+06],[2000, 2.95612600000000E+06]] },{ "name":"Syrian Arab Republic", "category":"Syrian Arab Republic","x": [[1981, 7.35842245524924E+01],[2002, 9.10285676619571E+01],[2004, 8.77581361883488E+01]], "y": [[1981, 3.70591588346079E+01],[2002, 7.42404402261833E+01],[2004, 7.36265610418379E+01]], "size": [[1981, 9.21969000000000E+06],[2002, 1.69629180000000E+07],[2004, 1.80047970000000E+07]] },{ "name":"Samoa", "category":"Samoa","x": [[1991, 9.84156862745098E+01],[2004, 9.89000000000000E+01]], "y": [[1991, 9.74217391304348E+01],[2004, 9.82000000000000E+01]], "size": [[1991, 1.62504000000000E+05],[2004, 1.79699000000000E+05]] },{ "name":"Uzbekistan", "category":"Uzbekistan","x": [[2000, 9.80070469059679E+01]], "y": [[2000, 9.58390249028055E+01]], "size": [[2000, 2.46505000000000E+07]] },{ "name":"West Bank and Gaza", "category":"West Bank and Gaza","x": [[1997, 9.22435073339397E+01],[2004, 9.65427911345807E+01],[2006, 9.70798895484259E+01],[2007, 9.72372136559995E+01],[2008, 9.71440074505778E+01]], "y": [[1997, 7.97266224380119E+01],[2004, 8.79517364186501E+01],[2006, 8.97569183991530E+01],[2007, 9.04651835306084E+01],[2008, 9.09028544129941E+01]], "size": [[1997, 2.70651800000000E+06],[2004, 3.45251681609414E+06],[2006, 3.70120305475224E+06],[2007, 3.83218500000000E+06],[2008, 3.93730900000000E+06]] },{ "name":"Oman", "category":"Oman","x": [[2003, 8.68623418996436E+01],[2008, 8.99993207480132E+01]], "y": [[2003, 7.35317142183447E+01],[2008, 8.08722581563022E+01]], "size": [[2003, 2.33596700000000E+06],[2008, 2.63696300000000E+06]] },{ "name":"Burundi", "category":"Burundi","x": [[1979, 3.42627147764740E+01],[1990, 4.82362458457092E+01],[2000, 6.73069306930693E+01]], "y": [[1979, 1.19835678814776E+01],[1990, 2.75292983816650E+01],[2000, 5.22377622377622E+01]], "size": [[1979, 4.01419000000000E+06],[1990, 5.60172000000000E+06],[2000, 6.37434700000000E+06]] },{ "name":"Turkey", "category":"Turkey","x": [[1975, 7.75039424966954E+01],[1980, 8.14494437993809E+01],[1985, 8.76197192068565E+01],[1990, 8.98470343950985E+01],[2004, 9.52734911529450E+01],[2005, 9.60006206602273E+01],[2006, 9.59956244872446E+01],[2007, 9.62018559579535E+01]], "y": [[1975, 4.50989205984787E+01],[1980, 4.98064066458463E+01],[1985, 6.42317240884216E+01],[1990, 6.85196551900786E+01],[2004, 7.95816931090699E+01],[2005, 8.05489534616269E+01],[2006, 8.03851613150727E+01],[2007, 8.12638268774386E+01]], "size": [[1975, 3.95858210000000E+07],[1980, 4.41052160000000E+07],[1985, 4.93996300000000E+07],[1990, 5.41302680000000E+07],[2004, 6.72359270000000E+07],[2005, 6.81431860000000E+07],[2006, 6.90635380000000E+07],[2007, 6.99927540000000E+07]] },{ "name":"Niger", "category":"Niger","x": [[2001, 9.38251300771484E+00],[2005, 4.29273720472152E+01]], "y": [[2001, 9.39872376795257E+00],[2005, 1.50841384496017E+01]], "size": [[2001, 1.13081340000000E+07],[2005, 1.29938840000000E+07]] },{ "name":"Mexico", "category":"Mexico","x": [[1980, 8.62426483517178E+01],[1990, 9.03474043830602E+01],[2000, 9.25593734937334E+01],[2002, 9.19977988858997E+01],[2004, 9.24496054192762E+01],[2005, 9.31904116012511E+01],[2006, 9.39011997169637E+01],[2007, 9.44415139491043E+01],[2008, 9.45921618077998E+01]], "y": [[1980, 7.98909989397727E+01],[1990, 8.49559065231632E+01],[2000, 8.86820398106524E+01],[2002, 8.87286302324290E+01],[2004, 8.96310201893090E+01],[2005, 9.02104128500907E+01],[2006, 8.98345108572933E+01],[2007, 9.13555512618148E+01],[2008, 9.14536079946457E+01]], "size": [[1980, 6.87764110000000E+07],[1990, 8.43066020000000E+07],[2000, 9.99595940000000E+07],[2002, 1.02634153000000E+08],[2004, 1.05175967000000E+08],[2005, 1.06483757000000E+08],[2006, 1.07835259000000E+08],[2007, 1.09220753000000E+08],[2008, 1.10627158000000E+08]] },{ "name":"Chad", "category":"Chad","x": [[1993, 1.82606000000000E+01],[2000, 4.08270575731815E+01],[2004, 3.93682483249009E+01]], "y": [[1993, 4.59183000000000E+00],[2000, 1.27964193738172E+01],[2004, 1.79805825242718E+01]], "size": [[1993, 6.58307900000000E+06],[2000, 8.22232700000000E+06],[2004, 9.47479200000000E+06]] },{ "name":"Mozambique", "category":"Mozambique","x": [[1980, 4.39546821839622E+01],[1997, 5.48188815298425E+01],[2003, 6.55771046705891E+01]], "y": [[1980, 1.21463152723296E+01],[1997, 2.49642038882807E+01],[2003, 3.31939590614079E+01]], "size": [[1980, 1.21455010000000E+07],[1997, 1.68623850000000E+07],[2003, 1.97210090000000E+07]] },{ "name":"Guam", "category":"Guam","x": [[1980, 9.63826631509558E+01]], "y": [[1980, 9.64630816896224E+01]], "size": [[1980, 1.06572000000000E+05]] },{ "name":"Benin", "category":"Benin","x": [[1979, 2.51900623859260E+01],[1992, 3.99033411846811E+01],[2002, 4.78659553391101E+01]], "y": [[1979, 9.53907998333526E+00],[1992, 1.65652394726964E+01],[2002, 2.33001376372241E+01]], "size": [[1979, 3.51691700000000E+06],[1992, 5.10833500000000E+06],[2002, 6.93798500000000E+06]] },{ "name":"Korea, Dem. Rep.", "category":"Korea, Dem. Rep.","x": [[2008, 9.99989629520247E+01]], "y": [[2008, 9.99976152595066E+01]], "size": [[2008, 2.41263290000000E+07]] },{ "name":"Romania", "category":"Romania","x": [[1992, 9.85320189119128E+01],[2002, 9.84044049676460E+01]], "y": [[1992, 9.49826909921119E+01],[2002, 9.62663163449829E+01]], "size": [[1992, 2.27942840000000E+07],[2002, 2.18031290000000E+07]] },{ "name":"Algeria", "category":"Algeria","x": [[1987, 6.33774328472004E+01],[2002, 7.95690936106984E+01],[2006, 8.12840426030348E+01]], "y": [[1987, 3.58399150765954E+01],[2002, 6.00750821210699E+01],[2006, 6.39187851604192E+01]], "size": [[1987, 2.33984700000000E+07],[2002, 3.14418480000000E+07],[2006, 3.33919540000000E+07]] },{ "name":"Madagascar", "category":"Madagascar","x": [[2000, 7.65309722761814E+01],[2008, 6.74173086709562E+01]], "y": [[2000, 6.52641610432870E+01],[2008, 6.16414061443533E+01]], "size": [[2000, 1.53642720000000E+07],[2008, 1.95462820000000E+07]] },{ "name":"Comoros", "category":"Comoros","x": [[1980, 5.59770392749245E+01],[2000, 7.45140388768898E+01]], "y": [[1980, 4.03176159423594E+01],[2000, 6.34590163934426E+01]], "size": [[1980, 3.28861000000000E+05],[2000, 5.62469000000000E+05]] },{ "name":"Belize", "category":"Belize","x": [[1991, 7.02687673772011E+01]], "y": [[1991, 7.03283939978644E+01]], "size": [[1991, 1.94000000000000E+05]] },{ "name":"Saudi Arabia", "category":"Saudi Arabia","x": [[1992, 7.99685268242385E+01],[2000, 8.70607739165577E+01],[2004, 8.94531133890928E+01]], "y": [[1992, 5.72778412818708E+01],[2000, 6.92911927938937E+01],[2004, 7.96530768310172E+01]], "size": [[1992, 1.71890750000000E+07],[2000, 2.00452760000000E+07],[2004, 2.32137670000000E+07]] },{ "name":"Gambia, The", "category":"Gambia, The","x": [[2000, 4.89811512990321E+01]], "y": [[2000, 2.50615460364353E+01]], "size": [[2000, 1.29708400000000E+06]] },{ "name":"Egypt, Arab Rep.", "category":"Egypt, Arab Rep.","x": [[1976, 5.36151947448609E+01],[1986, 5.69761596626570E+01],[1996, 6.71517832653418E+01],[2005, 8.30175184555892E+01],[2006, 7.46218046099146E+01]], "y": [[1976, 2.24380082097267E+01],[1986, 3.14041908024757E+01],[1996, 4.35953059268258E+01],[2005, 5.93555764191826E+01],[2006, 5.78119143391218E+01]], "size": [[1976, 4.10334080000000E+07],[1986, 5.18997280000000E+07],[1996, 6.31204980000000E+07],[2005, 7.42032150000000E+07],[2006, 7.55684530000000E+07]] },{ "name":"Congo, Dem. Rep.", "category":"Congo, Dem. Rep.","x": [[2001, 8.09120444495134E+01]], "y": [[2001, 5.40658207904827E+01]], "size": [[2001, 5.09894240000000E+07]] },{ "name":"Paraguay", "category":"Paraguay","x": [[1982, 8.10830687668302E+01],[1992, 9.20001461615567E+01],[2007, 9.57123848820378E+01]], "y": [[1982, 7.58529822355792E+01],[1992, 8.85587119918145E+01],[2007, 9.34532695594099E+01]], "size": [[1982, 3.38562600000000E+06],[1992, 4.46478000000000E+06],[2007, 6.11929500000000E+06]] },{ "name":"Lebanon", "category":"Lebanon","x": [[2007, 9.33789429416669E+01]], "y": [[2007, 8.59677815663135E+01]], "size": [[2007, 4.13487200000000E+06]] },{ "name":"Russian Federation", "category":"Russian Federation","x": [[1989, 9.94562353188011E+01],[2002, 9.96940786565286E+01]], "y": [[1989, 9.67581701725371E+01],[2002, 9.92283570111310E+01]], "size": [[1989, 1.47721000000000E+08],[2002, 1.45299690295609E+08]] },{ "name":"Colombia", "category":"Colombia","x": [[1993, 8.14975078309386E+01],[1996, 9.10891030370089E+01],[2004, 9.29041153123042E+01],[2005, 9.27779491389366E+01],[2006, 9.23928049900210E+01],[2007, 9.24297012141329E+01],[2008, 9.33168784855299E+01]], "y": [[1993, 8.12354817848529E+01],[1996, 9.13140001085853E+01],[2004, 9.27146274553549E+01],[2005, 9.29112476653780E+01],[2006, 9.22205958944221E+01],[2007, 9.28456239775655E+01],[2008, 9.34353732595696E+01]], "size": [[1993, 3.51462200000000E+07],[1996, 3.71126210000000E+07],[2004, 4.23857120000000E+07],[2005, 4.30405580000000E+07],[2006, 4.36965400000000E+07],[2007, 4.43523270000000E+07],[2008, 4.50057820000000E+07]] },{ "name":"Lesotho", "category":"Lesotho","x": [[2000, 7.99957819255510E+01]], "y": [[2000, 9.20464526202791E+01]], "size": [[2000, 1.96387800000000E+06]] },{ "name":"Malaysia", "category":"Malaysia","x": [[1980, 7.81463345817378E+01],[1991, 8.85629927540261E+01],[2000, 9.19692432526939E+01]], "y": [[1980, 6.12484956656288E+01],[1991, 7.72830875053545E+01],[2000, 8.53542236657321E+01]], "size": [[1980, 1.38325860000000E+07],[1991, 1.87077740000000E+07],[2000, 2.34149090000000E+07]] },{ "name":"El Salvador", "category":"El Salvador","x": [[1992, 7.73724058195084E+01],[2006, 8.66953355578770E+01],[2007, 8.48640694304705E+01],[2008, 8.70546795055408E+01]], "y": [[1992, 7.12805324491241E+01],[2006, 8.10038246223495E+01],[2007, 7.96621282105792E+01],[2008, 8.13595021754258E+01]], "size": [[1992, 5.49848900000000E+06],[2006, 6.07448700000000E+06],[2007, 6.10086800000000E+06],[2008, 6.12962800000000E+06]] },{ "name":"Vanuatu", "category":"Vanuatu","x": [[1979, 5.73351029352758E+01],[1994, 7.13000000000000E+01],[2004, 8.02000000000000E+01]], "y": [[1979, 4.77825918489556E+01],[1994, 6.56000000000000E+01],[2004, 7.62000000000000E+01]], "size": [[1979, 1.12587000000000E+05],[1994, 1.64254000000000E+05],[2004, 2.05561000000000E+05]] },{ "name":"Aruba", "category":"Aruba","x": [[2000, 9.75374007264668E+01]], "y": [[2000, 9.70713598240066E+01]], "size": [[2000, 9.02710000000000E+04]] },{ "name":"South Africa", "category":"South Africa","x": [[1980, 7.75255953483019E+01],[1996, 8.40713779349059E+01],[2007, 9.07175869356744E+01]], "y": [[1980, 7.48071886445019E+01],[1996, 8.09286292432999E+01],[2007, 8.70431020244616E+01]], "size": [[1980, 2.75760000000000E+07],[1996, 4.00002469537564E+07],[2007, 4.82572820000000E+07]] },{ "name":"Albania", "category":"Albania","x": [[2001, 9.91876063431248E+01],[2008, 9.73062020102419E+01]], "y": [[2001, 9.82522739777769E+01],[2008, 9.46818142536036E+01]], "size": [[2001, 3.07737800000000E+06],[2008, 3.18139700000000E+06]] },{ "name":"Iran, Islamic Rep.", "category":"Iran, Islamic Rep.","x": [[1976, 4.81833256526589E+01],[1986, 6.30995531720072E+01],[1991, 7.42744823721143E+01],[1996, 7.98716114940983E+01],[2002, 8.35000000000000E+01],[2005, 8.80103187546030E+01],[2006, 8.72721940900327E+01],[2008, 8.92784842752280E+01]], "y": [[1976, 2.44230830266728E+01],[1986, 4.10339498365534E+01],[1991, 5.61564167008308E+01],[1996, 6.60677639548348E+01],[2002, 7.04000000000000E+01],[2005, 7.68026379522878E+01],[2006, 7.72400181952893E+01],[2008, 8.06553220629719E+01]], "size": [[1976, 3.37888670000000E+07],[1986, 4.82573110000000E+07],[1991, 5.60715450000000E+07],[1996, 6.08156860000000E+07],[2002, 6.72128500000000E+07],[2005, 6.97320070000000E+07],[2006, 7.05820860000000E+07],[2008, 7.22892910000000E+07]] },{ "name":"Central African Republic", "category":"Central African Republic","x": [[1975, 2.95929212444422E+01],[1988, 4.80202995649453E+01],[2000, 6.47666997308995E+01]], "y": [[1975, 8.39957585419262E+00],[1988, 2.03368802391990E+01],[2000, 3.34989494137968E+01]], "size": [[1975, 2.01736200000000E+06],[1988, 2.80776800000000E+06],[2000, 3.70160700000000E+06]] },{ "name":"Slovenia", "category":"Slovenia","x": [[1991, 9.96020906690732E+01],[2004, 9.97000000000000E+01]], "y": [[1991, 9.94537520703274E+01],[2004, 9.96000000000000E+01]], "size": [[1991, 1.99942900000000E+06],[2004, 1.99701200000000E+06]] },{ "name":"Burkina Faso", "category":"Burkina Faso","x": [[1975, 1.45284903241232E+01],[1991, 1.96261336855037E+01],[1996, 1.85177895900709E+01],[2003, 2.93620039532494E+01],[2005, 3.14419259350713E+01],[2007, 3.66806668429500E+01]], "y": [[1975, 3.18276569531967E+00],[1991, 8.22542742681241E+00],[1996, 8.05798027171092E+00],[2003, 1.51887677129880E+01],[2005, 1.66222416379275E+01],[2007, 2.15795652948935E+01]], "size": [[1975, 6.43527400000000E+06],[1991, 9.58003500000000E+06],[1996, 1.09921700000000E+07],[2003, 1.33955990000000E+07],[2005, 1.41984630000000E+07],[2007, 1.50611270000000E+07]] },{ "name":"Mongolia", "category":"Mongolia","x": [[2000, 9.80167757937831E+01]], "y": [[2000, 9.75287998946392E+01]], "size": [[2000, 2.41136900000000E+06]] },{ "name":"Guatemala", "category":"Guatemala","x": [[1994, 7.17063885760926E+01],[2002, 7.54155795269306E+01]], "y": [[1994, 5.72926610904738E+01],[2002, 6.33413810180763E+01]], "size": [[1994, 9.78828400000000E+06],[2002, 1.18003510000000E+07]] },{ "name":"Mauritania", "category":"Mauritania","x": [[2000, 5.95403312967333E+01]], "y": [[2000, 4.34173588599364E+01]], "size": [[2000, 2.64274300000000E+06]] },{ "name":"Timor-Leste", "category":"Timor-Leste","x": [[2001, 4.53000000000000E+01],[2007, 5.85000000000000E+01]], "y": [[2001, 3.00000000000000E+01],[2007, 4.25000000000000E+01]], "size": [[2001, 8.52522000000000E+05],[2007, 1.06077000000000E+06]] },{ "name":"Yemen, Rep.", "category":"Yemen, Rep.","x": [[1994, 5.67247499325807E+01],[2004, 7.41000000000000E+01]], "y": [[1994, 1.70595646640101E+01],[2004, 3.53000000000000E+01]], "size": [[1994, 1.45302750000000E+07],[2004, 2.00261170000000E+07]] },{ "name":"Hungary", "category":"Hungary","x": [[1980, 9.93031937955227E+01],[1994, 9.93000000000000E+01],[2004, 9.91000000000000E+01]], "y": [[1980, 9.84541295921320E+01],[1994, 9.87000000000000E+01],[2004, 9.88000000000000E+01]], "size": [[1980, 1.07111220000000E+07],[1994, 1.03433550000000E+07],[2004, 1.01071460000000E+07]] },{ "name":"Mauritius", "category":"Mauritius","x": [[1990, 8.51457532938291E+01],[2000, 8.82278612837158E+01]], "y": [[1990, 7.46608867016178E+01],[2000, 8.05000291522961E+01]], "size": [[1990, 1.05877500000000E+06],[2000, 1.18687300000000E+06]] },{ "name":"Argentina", "category":"Argentina","x": [[1980, 9.42633913766788E+01],[1991, 9.62212710126556E+01],[2001, 9.71932036332257E+01]], "y": [[1980, 9.35808944919856E+01],[1991, 9.60413584906962E+01],[2001, 9.71934107782587E+01]], "size": [[1980, 2.81310400000000E+07],[1991, 3.30935790000000E+07],[2001, 3.73021160000000E+07]] },{ "name":"Poland", "category":"Poland","x": [[1978, 9.92751665677945E+01],[1994, 9.95000000000000E+01],[2004, 9.96000000000000E+01]], "y": [[1978, 9.82519799532424E+01],[1994, 9.89000000000000E+01],[2004, 9.92000000000000E+01]], "size": [[1978, 3.49656000000000E+07],[1994, 3.85426520000000E+07],[2004, 3.81822220000000E+07]] },{ "name":"Georgia", "category":"Georgia","x": [[2002, 9.97689768353979E+01]], "y": [[2002, 9.95528537975224E+01]], "size": [[2002, 4.35700000000000E+06]] },{ "name":"Bulgaria", "category":"Bulgaria","x": [[2001, 9.87366046458907E+01]], "y": [[2001, 9.77064858717381E+01]], "size": [[2001, 8.02028200000000E+06]] },{ "name":"Angola", "category":"Angola","x": [[2001, 8.29021772762435E+01]], "y": [[2001, 5.42113253028221E+01]], "size": [[2001, 1.43882440000000E+07]] },{ "name":"Cuba", "category":"Cuba","x": [[2002, 9.98073139207372E+01]], "y": [[2002, 9.97909221600559E+01]], "size": [[2002, 1.11754340000000E+07]] },{ "name":"Greece", "category":"Greece","x": [[1981, 9.60638038019644E+01],[1991, 9.60374581181265E+01],[2001, 9.78112176904073E+01]], "y": [[1981, 8.53199873194528E+01],[1991, 8.93532957314904E+01],[2001, 9.42394115200321E+01]], "size": [[1981, 9.72935000000000E+06],[1991, 1.02562920000000E+07],[2001, 1.09499570000000E+07]] },{ "name":"Maldives", "category":"Maldives","x": [[1977, 8.24048459410474E+01],[1985, 9.21140059450953E+01],[1990, 9.58971325167038E+01],[1995, 9.62122734086449E+01],[2000, 9.62122734086449E+01],[2006, 9.83656876533451E+01]], "y": [[1977, 8.21781629883975E+01],[1985, 9.23590120044909E+01],[1990, 9.61460111215108E+01],[1995, 9.64429805207086E+01],[2000, 9.64429805207086E+01],[2006, 9.84298471595711E+01]], "size": [[1977, 1.43701000000000E+05],[1985, 1.86720000000000E+05],[1990, 2.19474000000000E+05],[1995, 2.48712000000000E+05],[2000, 2.73236000000000E+05],[2006, 2.99419000000000E+05]] },{ "name":"Thailand", "category":"Thailand","x": [[1980, 9.22129561357845E+01],[2000, 9.49015673609157E+01],[2005, 9.56002487578205E+01]], "y": [[1980, 8.38933541919900E+01],[2000, 9.05160168482374E+01],[2005, 9.15295486782417E+01]], "size": [[1980, 4.74826430000000E+07],[2000, 6.31550290000000E+07],[2005, 6.66984830000000E+07]] },{ "name":"Costa Rica", "category":"Costa Rica","x": [[1984, 9.26821443847726E+01],[2000, 9.46501803709260E+01]], "y": [[1984, 9.25771293243078E+01],[2000, 9.50807910400585E+01]], "size": [[1984, 2.61905800000000E+06],[2000, 3.91918000000000E+06]] },{ "name":"Ukraine", "category":"Ukraine","x": [[2001, 9.97434302365547E+01]], "y": [[2001, 9.91715723805537E+01]], "size": [[2001, 4.86838645779071E+07]] },{ "name":"Tajikistan", "category":"Tajikistan","x": [[1989, 9.87910905433728E+01],[2000, 9.96846152564641E+01]], "y": [[1989, 9.66418026229340E+01],[2000, 9.92217355833226E+01]], "size": [[1989, 5.17028500000000E+06],[2000, 6.17280700000000E+06]] },{ "name":"Sri Lanka", "category":"Sri Lanka","x": [[1981, 9.13484027861297E+01],[2001, 9.22701973036440E+01],[2006, 9.27136540321995E+01],[2008, 9.22439330666122E+01]], "y": [[1981, 8.20219742738346E+01],[2001, 8.91357642652876E+01],[2006, 8.90913523171477E+01],[2008, 8.90734723237341E+01]], "size": [[1981, 1.53178170000000E+07],[2001, 1.89217940000000E+07],[2006, 2.00620700000000E+07],[2008, 2.04737990000000E+07]] },{ "name":"Italy", "category":"Italy","x": [[1981, 9.74646489735084E+01],[2001, 9.88236890089346E+01]], "y": [[1981, 9.55366691085642E+01],[2001, 9.80421528669028E+01]], "size": [[1981, 5.65016750000000E+07],[2001, 5.69772170000000E+07]] },{ "name":"Iraq", "category":"Iraq","x": [[2000, 8.40882400199819E+01]], "y": [[2000, 6.41680866560382E+01]], "size": [[2000, 2.43136405000000E+07]] },{ "name":"Tonga", "category":"Tonga","x": [[1976, 9.96586593847335E+01],[1996, 9.88340620445555E+01],[2006, 9.89538814824265E+01]], "y": [[1976, 9.95255348516218E+01],[1996, 9.89755497882803E+01],[2006, 9.90825107567704E+01]], "size": [[1976, 8.92520000000000E+04],[1996, 9.61960000000000E+04],[2006, 1.01584000000000E+05]] },{ "name":"India", "category":"India","x": [[1981, 5.48410182209359E+01],[1991, 6.16419196303034E+01],[2001, 7.34118557727339E+01],[2006, 7.51918984995641E+01]], "y": [[1981, 2.56762520364460E+01],[1991, 3.37295267624506E+01],[2001, 4.78420986403667E+01],[2006, 5.08237564698658E+01]], "size": [[1981, 7.16493309000000E+08],[1991, 8.91910180000000E+08],[2001, 1.07137426400000E+09],[2006, 1.15703853900000E+09]] },{ "name":"Moldova", "category":"Moldova","x": [[1989, 9.86140505645822E+01],[2000, 9.79776247848537E+01]], "y": [[1989, 9.44444775905685E+01],[2000, 9.54922983992751E+01]], "size": [[1989, 3.68100000000000E+06],[2000, 3.63958800000000E+06]] },{ "name":"Jordan", "category":"Jordan","x": [[1979, 8.04826111197093E+01],[2003, 9.50845008513891E+01],[2005, 9.51764489081360E+01],[2007, 9.54945515507125E+01]], "y": [[1979, 5.21106130942853E+01],[2003, 8.47139248317488E+01],[2005, 8.70058089467174E+01],[2007, 8.89033122566057E+01]], "size": [[1979, 2.09931200000000E+06],[2003, 5.16400000000000E+06],[2005, 5.41150000000000E+06],[2007, 5.66200000000000E+06]] },{ "name":"Senegal", "category":"Senegal","x": [[1988, 3.69028792133993E+01],[2002, 5.10515331786385E+01],[2006, 5.22584807490910E+01]], "y": [[1988, 1.78632660373953E+01],[2002, 2.92473426420034E+01],[2006, 3.29875849937776E+01]], "size": [[1988, 6.81849500000000E+06],[2002, 1.00231940000000E+07],[2006, 1.11695490000000E+07]] },{ "name":"Papua New Guinea", "category":"Papua New Guinea","x": [[2000, 6.34452190166452E+01]], "y": [[2000, 5.09177355829862E+01]], "size": [[2000, 5.37882400000000E+06]] },{ "name":"Guinea", "category":"Guinea","x": [[2003, 4.25563909774436E+01]], "y": [[2003, 1.81104936253678E+01]], "size": [[2003, 8.74395400000000E+06]] },{ "name":"Cyprus", "category":"Cyprus","x": [[1992, 9.78305865013260E+01],[2001, 9.86310439581468E+01]], "y": [[1992, 9.10017808653948E+01],[2001, 9.50796648048727E+01]], "size": [[1992, 8.00707000000000E+05],[2001, 9.61482000000000E+05]] },{ "name":"Eritrea", "category":"Eritrea","x": [[2002, 6.53901231879810E+01]], "y": [[2002, 4.02244227353464E+01]], "size": [[2002, 3.97397300000000E+06]] },{ "name":"Namibia", "category":"Namibia","x": [[1991, 7.78081159966105E+01],[2001, 8.67704466435409E+01]], "y": [[1991, 7.39865970799779E+01],[2001, 8.34900882909773E+01]], "size": [[1991, 1.46520100000000E+06],[2001, 1.93639900000000E+06]] },{ "name":"Kuwait", "category":"Kuwait","x": [[1975, 6.80286325695479E+01],[1980, 7.27876522735376E+01],[1985, 7.81973002001283E+01],[1995, 8.11209465943706E+01],[2005, 9.44460364274449E+01],[2006, 9.45252221069113E+01],[2007, 9.51511751824231E+01],[2008, 9.50202546881070E+01]], "y": [[1975, 4.80152140597720E+01],[1980, 5.91105018804140E+01],[1985, 6.88493664305826E+01],[1995, 7.41487169707766E+01],[2005, 9.10425000810452E+01],[2006, 9.08286339090251E+01],[2007, 9.31182573925424E+01],[2008, 9.17930211236185E+01]], "size": [[1975, 1.05375300000000E+06],[1980, 1.37696300000000E+06],[1985, 1.74208300000000E+06],[1995, 1.62791100000000E+06],[2005, 2.26401400000000E+06],[2006, 2.35144100000000E+06],[2007, 2.44781800000000E+06],[2008, 2.54835100000000E+06]] },{ "name":"Caribbean small states", "category":"Caribbean small states","x": [[2000, 8.38107807891000E+01]], "y": [[2000, 8.98255242672000E+01]], "size": [[2000, 6.45337855137656E+06]] },{ "name":"Myanmar", "category":"Myanmar","x": [[1983, 8.57883646631028E+01],[2000, 9.38588354716781E+01]], "y": [[1983, 7.16308744453878E+01],[2000, 8.63685100012979E+01]], "size": [[1983, 3.48326360000000E+07],[2000, 4.49576600000000E+07]] },{ "name":"Ghana", "category":"Ghana","x": [[2000, 6.63512777903794E+01]], "y": [[2000, 4.97919623692566E+01]], "size": [[2000, 1.91654900000000E+07]] },{ "name":"Pakistan", "category":"Pakistan","x": [[1981, 3.53806523160984E+01],[1998, 5.52966081722827E+01],[2005, 6.40604754552282E+01],[2006, 6.76518438177874E+01],[2008, 6.88660998509087E+01]], "y": [[1981, 1.47715523759109E+01],[1998, 2.90438391097556E+01],[2005, 3.53675197697038E+01],[2006, 3.96132336095950E+01],[2008, 4.00811794345433E+01]], "size": [[1981, 8.32801370000000E+07],[1998, 1.37808222000000E+08],[2005, 1.58645463000000E+08],[2006, 1.61513324000000E+08],[2008, 1.67442258000000E+08]] },{ "name":"Macao SAR, China", "category":"Macao SAR, China","x": [[1981, 9.28096844012684E+01],[2001, 9.52762104710668E+01],[2006, 9.64699876011961E+01]], "y": [[1981, 8.62158843676626E+01],[2001, 8.77749719571428E+01],[2006, 9.07235891329837E+01]], "size": [[1981, 2.52251000000000E+05],[2001, 4.40265000000000E+05],[2006, 4.93267000000000E+05]] },{ "name":"Uruguay", "category":"Uruguay","x": [[1975, 9.33882616214017E+01],[1985, 9.48336140310123E+01],[1996, 9.62445266720123E+01],[2006, 9.74447820487071E+01],[2007, 9.74216915520069E+01],[2008, 9.78312789286173E+01]], "y": [[1975, 9.43045220377791E+01],[1985, 9.58815375593112E+01],[1996, 9.72709597358028E+01],[2006, 9.80843593678520E+01],[2007, 9.82419334974084E+01],[2008, 9.84636604900629E+01]], "size": [[1975, 2.82939100000000E+06],[1985, 3.01076600000000E+06],[1996, 3.23554900000000E+06],[2006, 3.31446600000000E+06],[2007, 3.32390600000000E+06],[2008, 3.33405200000000E+06]] },{ "name":"Gabon", "category":"Gabon","x": [[1993, 7.94441789053447E+01],[2004, 8.84000000000000E+01]], "y": [[1993, 6.53263103802672E+01],[2004, 7.94000000000000E+01]], "size": [[1993, 1.02353100000000E+06],[2004, 1.34417100000000E+06]] },{ "name":"Libya", "category":"Libya","x": [[1984, 7.69926275888501E+01],[1994, 8.82000000000000E+01],[2004, 9.36000000000000E+01]], "y": [[1984, 4.23135535998274E+01],[1994, 6.49000000000000E+01],[2004, 7.82000000000000E+01]], "size": [[1984, 3.70814200000000E+06],[1994, 4.68710600000000E+06],[2004, 5.65279700000000E+06]] },{ "name":"Rwanda", "category":"Rwanda","x": [[1978, 5.08232631881928E+01],[1991, 5.78534877300000E+01],[2000, 7.14353034014067E+01]], "y": [[1978, 2.65735766723781E+01],[1991, 5.78534877300000E+01],[2000, 5.97578192613862E+01]], "size": [[1978, 4.84774700000000E+06],[1991, 6.87119200000000E+06],[2000, 8.09834400000000E+06]] },{ "name":"Armenia", "category":"Armenia","x": [[1989, 9.94038476863893E+01],[2001, 9.96722296817552E+01]], "y": [[1989, 9.81501361103865E+01],[2001, 9.91610655332609E+01]], "size": [[1989, 3.54272000000000E+06],[2001, 3.06581000000000E+06]] },{ "name":"Swaziland", "category":"Swaziland","x": [[1976, 5.73843858776728E+01],[1986, 6.96834690842568E+01],[2000, 8.09036618630345E+01]], "y": [[1976, 5.36659591515441E+01],[1986, 6.52228821956065E+01],[2000, 7.83497280512984E+01]], "size": [[1976, 5.33202000000000E+05],[1986, 7.34925000000000E+05],[2000, 1.01078654924681E+06]] },{ "name":"Equatorial Guinea", "category":"Equatorial Guinea","x": [[2000, 9.33551553823362E+01]], "y": [[2000, 8.04622693928516E+01]], "size": [[2000, 5.20380000000000E+05]] },{ "name":"Brazil", "category":"Brazil","x": [[1980, 7.63773646709077E+01],[2000, 8.62279845681086E+01],[2004, 8.84094616132296E+01],[2006, 8.93532406842345E+01],[2007, 8.97721405450453E+01],[2008, 8.98378742274488E+01]], "y": [[1980, 7.28531478096684E+01],[2000, 8.65000478085114E+01],[2004, 8.88061266471471E+01],[2006, 8.98555920023890E+01],[2007, 9.02280073145367E+01],[2008, 9.02195549675079E+01]], "size": [[1980, 1.21711864000000E+08],[2000, 1.74425387000000E+08],[2004, 1.83873377000000E+08],[2006, 1.87958211000000E+08],[2007, 1.89798070000000E+08],[2008, 1.91543237000000E+08]] },{ "name":"Croatia", "category":"Croatia","x": [[1991, 9.87570597756666E+01],[2001, 9.93205917434000E+01]], "y": [[1991, 9.48172219600950E+01],[2001, 9.70838976517409E+01]], "size": [[1991, 4.51000000000000E+06],[2001, 4.44000000000000E+06]] },{ "name":"Cameroon", "category":"Cameroon","x": [[1976, 5.46298474853998E+01],[2000, 7.91945240369309E+01],[2007, 7.89499621868683E+01]], "y": [[1976, 2.91161285248785E+01],[2000, 5.87217615098656E+01],[2007, 6.30220576341953E+01]], "size": [[1976, 8.07287900000000E+06],[2000, 1.56782690000000E+07],[2007, 1.83500220000000E+07]] },{ "name":"Cote d'Ivoire", "category":"Cote d'Ivoire","x": [[1988, 4.43635384514439E+01],[1998, 4.39464204978041E+01],[2000, 6.08355206383925E+01]], "y": [[1988, 2.34337822886898E+01],[1998, 2.84766706568249E+01],[2000, 3.86187472964953E+01]], "size": [[1988, 1.16943180000000E+07],[1998, 1.58785550000000E+07],[2000, 1.65816530000000E+07]] },{ "name":"Zimbabwe", "category":"Zimbabwe","x": [[1982, 8.41746255668521E+01],[1992, 8.88933836557054E+01]], "y": [[1982, 7.18539280610294E+01],[1992, 7.85170178574653E+01]], "size": [[1982, 7.87464200000000E+06],[1992, 1.10056900000000E+07]] },{ "name":"Qatar", "category":"Qatar","x": [[1986, 7.67958266650252E+01],[1997, 8.42445592032460E+01],[2004, 8.91042663709583E+01],[2007, 9.38068198112937E+01],[2008, 9.42905956939025E+01]], "y": [[1986, 7.24589473684211E+01],[1997, 8.08886829276987E+01],[2004, 8.86092194073671E+01],[2007, 9.04361208921586E+01],[2008, 9.26638248448357E+01]], "size": [[1986, 3.95144000000000E+05],[1997, 5.28787000000000E+05],[2004, 7.15146000000000E+05],[2007, 1.17819200000000E+06],[2008, 1.39606000000000E+06]] },{ "name":"Nigeria", "category":"Nigeria","x": [[1991, 6.76537448357805E+01],[2003, 6.67674345877202E+01]], "y": [[1991, 4.37291970741608E+01],[2003, 4.33220541401274E+01]], "size": [[1991, 9.99861360000000E+07],[2003, 1.33067097000000E+08]] },{ "name":"Estonia", "category":"Estonia","x": [[1989, 9.98759844971596E+01],[2000, 9.97759462759463E+01]], "y": [[1989, 9.96014830502083E+01],[2000, 9.97600609305853E+01]], "size": [[1989, 1.56813100000000E+06],[2000, 1.36951500000000E+06]] },{ "name":"Spain", "category":"Spain","x": [[1981, 9.58975268086971E+01],[1991, 9.80354880952493E+01],[2007, 9.86334577763066E+01],[2008, 9.84023037542662E+01]], "y": [[1981, 8.99369219380133E+01],[1991, 9.50509963335018E+01],[2007, 9.72603227322818E+01],[2008, 9.68868391471882E+01]], "size": [[1981, 3.77405560000000E+07],[1991, 3.89390490000000E+07],[2007, 4.48789450000000E+07],[2008, 4.55557160000000E+07]] },{ "name":"Palau", "category":"Palau","x": [[1980, 9.32873789594617E+01]], "y": [[1980, 9.05032375326593E+01]], "size": [[1980, 1.21970000000000E+04]] },{ "name":"Israel", "category":"Israel","x": [[1983, 9.49633954569737E+01]], "y": [[1983, 8.86747170300862E+01]], "size": [[1983, 4.10500000000000E+06]] },{ "name":"Bhutan", "category":"Bhutan","x": [[2005, 6.50477766414579E+01]], "y": [[2005, 3.86806566289195E+01]], "size": [[2005, 6.59293000000000E+05]] },{ "name":"Brunei Darussalam", "category":"Brunei Darussalam","x": [[1981, 8.51777527361418E+01],[1991, 9.24521891610499E+01],[2001, 9.51504242735922E+01]], "y": [[1981, 6.89825841024114E+01],[1991, 8.24613562781088E+01],[2001, 9.01615450018219E+01]], "size": [[1981, 1.95394000000000E+05],[1991, 2.59357000000000E+05],[2001, 3.34348000000000E+05]] },{ "name":"Azerbaijan", "category":"Azerbaijan","x": [[1999, 9.94724183412212E+01],[2007, 9.97998373678614E+01]], "y": [[1999, 9.81747845964480E+01],[2007, 9.92221639573501E+01]], "size": [[1999, 7.98275000000000E+06],[2007, 8.58130000000000E+06]] },{ "name":"Nepal", "category":"Nepal","x": [[1981, 3.16727479923121E+01],[1991, 4.92200161194158E+01],[2001, 6.27080091908529E+01]], "y": [[1981, 9.15311604283481E+00],[1991, 1.73817931422168E+01],[2001, 3.48867638756996E+01]], "size": [[1981, 1.54054560000000E+07],[1991, 1.95541700000000E+07],[2001, 2.49801840000000E+07]] },{ "name":"Bolivia", "category":"Bolivia","x": [[1976, 7.58428876425489E+01],[1992, 8.81555874293923E+01],[2001, 9.30574726419567E+01],[2007, 9.60362567771790E+01],[2008, 9.49554324750749E+01]], "y": [[1976, 5.13746452487902E+01],[1992, 7.23132170501620E+01],[2001, 8.06543829222586E+01],[2007, 8.59859392890179E+01],[2008, 8.68317538591247E+01]], "size": [[1976, 4.87727500000000E+06],[1992, 6.97416800000000E+06],[2001, 8.47670900000000E+06],[2007, 9.46349700000000E+06],[2008, 9.61846600000000E+06]] },{ "name":"Solomon Islands", "category":"Solomon Islands","x": [[1999, 8.37000000000000E+01]], "y": [[1999, 6.90000000000000E+01]], "size": [[1999, 3.97627000000000E+05]] },{ "name":"Vietnam", "category":"Vietnam","x": [[1979, 9.03814735271948E+01],[1989, 9.30029883359866E+01],[1999, 9.39182622852875E+01],[2000, 9.39326837909655E+01]], "y": [[1979, 7.81403902217465E+01],[1989, 8.28293915301559E+01],[1999, 8.69200801933815E+01],[2000, 8.66101131071191E+01]], "size": [[1979, 5.25735792000000E+07],[1989, 6.47740000000000E+07],[1999, 7.65967000000000E+07],[2000, 7.76309000000000E+07]] },{ "name":"Liberia", "category":"Liberia","x": [[1984, 4.48793161387183E+01],[1994, 5.48000000000000E+01],[2004, 6.12000000000000E+01]], "y": [[1984, 1.93027913485792E+01],[1994, 3.13000000000000E+01],[2004, 4.69000000000000E+01]], "size": [[1984, 2.17947100000000E+06],[1994, 2.03992200000000E+06],[2004, 3.09272100000000E+06]] },{ "name":"Turkmenistan", "category":"Turkmenistan","x": [[1995, 9.93249823741924E+01]], "y": [[1995, 9.82617654879022E+01]], "size": [[1995, 4.18801000000000E+06]] },{ "name":"Kenya", "category":"Kenya","x": [[2000, 7.76546089465714E+01]], "y": [[2000, 7.02277655429613E+01]], "size": [[2000, 3.12537010000000E+07]] },{ "name":"Ethiopia", "category":"Ethiopia","x": [[1994, 3.59825434962952E+01],[2004, 5.00000000000000E+01],[2008, 4.19366193724152E+01]], "y": [[1994, 1.85149809597309E+01],[2004, 2.28000000000000E+01],[2008, 1.79771972322585E+01]], "size": [[1994, 5.52810540000000E+07],[2004, 7.25266200000000E+07],[2008, 7.94464190000000E+07]] },{ "name":"Macedonia, FYR", "category":"Macedonia, FYR","x": [[1994, 9.72323472896581E+01],[2002, 9.82127793318038E+01]], "y": [[1994, 9.09280239461651E+01],[2002, 9.40560678005950E+01]], "size": [[1994, 1.95387400000000E+06],[2002, 2.02225500000000E+06]] },{ "name":"Honduras", "category":"Honduras","x": [[2001, 7.97852308779764E+01],[2007, 8.37460250394716E+01]], "y": [[2001, 8.02236016770126E+01],[2007, 8.34527736517551E+01]], "size": [[2001, 6.34727200000000E+06],[2007, 7.15881900000000E+06]] },{ "name":"Peru", "category":"Peru","x": [[1981, 9.01435309752785E+01],[1993, 9.28510081849442E+01],[2004, 9.34606994115635E+01],[2005, 9.37183059148053E+01],[2006, 9.42258215642469E+01],[2007, 9.48570296590555E+01]], "y": [[1981, 7.38583370205668E+01],[1993, 8.16587530500569E+01],[2004, 8.20626204412733E+01],[2005, 8.24543671454057E+01],[2006, 8.34548652895342E+01],[2007, 8.46468777849732E+01]], "size": [[1981, 1.77200170000000E+07],[1993, 2.29801820000000E+07],[2004, 2.72420330000000E+07],[2005, 2.75587690000000E+07],[2006, 2.78663870000000E+07],[2007, 2.81660780000000E+07]] },{ "name":"Malawi", "category":"Malawi","x": [[1987, 6.52795037162295E+01],[1998, 7.49264099521393E+01]], "y": [[1987, 3.35230223051309E+01],[1998, 5.39971155960380E+01]], "size": [[1987, 8.12834000000000E+06],[1998, 1.06123530000000E+07]] },{ "name":"Tunisia", "category":"Tunisia","x": [[1984, 6.04072344896142E+01],[2004, 8.33850931677019E+01],[2008, 8.63758144987701E+01]], "y": [[1984, 3.57675668683617E+01],[2004, 6.53478593272171E+01],[2008, 7.09641765651336E+01]], "size": [[1984, 7.04255014039959E+06],[2004, 9.93240000000000E+06],[2008, 1.03289000000000E+07]] },{ "name":"Sao Tome and Principe", "category":"Sao Tome and Principe","x": [[1981, 7.31411530815109E+01],[1991, 8.52496367718928E+01],[2001, 9.22346672185002E+01]], "y": [[1981, 4.23633833540186E+01],[1991, 6.19204782513933E+01],[2001, 7.79492345873160E+01]], "size": [[1981, 9.67210000000000E+04],[1991, 1.18512000000000E+05],[2001, 1.43430000000000E+05]] },{ "name":"China", "category":"China","x": [[1982, 7.91917809583307E+01],[1990, 8.70249797038148E+01],[2000, 9.51352520162161E+01]], "y": [[1982, 5.11368083841293E+01],[1990, 6.80720774247825E+01],[2000, 8.65265951032606E+01]], "size": [[1982, 1.00863000000000E+09],[1990, 1.13518500000000E+09],[2000, 1.26264500000000E+09]] },{ "name":"New Caledonia", "category":"New Caledonia","x": [[1976, 9.21909396361951E+01],[1989, 9.40441865812888E+01],[1996, 9.67847723244812E+01]], "y": [[1976, 9.03107861060329E+01],[1989, 9.20734413135123E+01],[1996, 9.54652968235311E+01]], "size": [[1976, 1.36203200000000E+05],[1989, 1.64200000000000E+05],[1996, 1.97000000000000E+05]] },{ "name":"Antigua and Barbuda", "category":"Antigua and Barbuda","x": [[2001, 9.84000000000000E+01],[2008, 9.84000000000000E+01]], "y": [[2001, 9.94200000000000E+01],[2008, 9.94200000000000E+01]], "size": [[2001, 7.91650000000000E+04],[2008, 8.68810000000000E+04]] },{ "name":"Lithuania", "category":"Lithuania","x": [[1989, 9.92068148859777E+01],[2001, 9.96431475858691E+01]], "y": [[1989, 9.77815880717133E+01],[2001, 9.96479433015227E+01]], "size": [[1989, 3.68425500000000E+06],[2001, 3.48129200000000E+06]] },{ "name":"Togo", "category":"Togo","x": [[2000, 6.86766119491043E+01],[2006, 7.02702720717526E+01]], "y": [[2000, 3.84635279986382E+01],[2006, 4.43766257885113E+01]], "size": [[2000, 4.79350400000000E+06],[2006, 5.52990800000000E+06]] },{ "name":"Seychelles", "category":"Seychelles","x": [[1987, 8.29316635884499E+01],[1994, 8.70151569399690E+01],[2002, 9.14073230377542E+01],[2008, 9.14073230400000E+01]], "y": [[1987, 8.54893039940505E+01],[1994, 8.85865984575437E+01],[2002, 9.22589795177941E+01],[2008, 9.22589795200000E+01]], "size": [[1987, 6.83523456000000E+04],[1994, 7.39246119202085E+04],[2002, 8.37000000000000E+04],[2008, 8.69560000000000E+04]] },{ "name":"Uganda", "category":"Uganda","x": [[1991, 6.81980910580320E+01],[2002, 7.83040194097590E+01]], "y": [[1991, 4.48266922766797E+01],[2002, 5.89098829787251E+01]], "size": [[1991, 1.83147010000000E+07],[2002, 2.57943970000000E+07]] },{ "name":"Suriname", "category":"Suriname","x": [[2004, 9.20163300747878E+01],[2008, 9.54929391033861E+01]], "y": [[2004, 8.71974362895714E+01],[2008, 9.37653714721710E+01]], "size": [[2004, 4.93236000000000E+05],[2008, 5.15066000000000E+05]] },{ "name":"Jamaica", "category":"Jamaica","x": [[1999, 7.40818370459589E+01]], "y": [[1999, 8.58720822372328E+01]], "size": [[1999, 2.57428936407701E+06]] },{ "name":"Malta", "category":"Malta","x": [[1985, 8.76568647158487E+01],[1995, 8.64302787737291E+01],[2005, 9.11865843322436E+01]], "y": [[1985, 8.82927464513609E+01],[1995, 8.92426444723201E+01],[2005, 9.35042514210551E+01]], "size": [[1985, 3.36452000000000E+05],[1995, 3.70433000000000E+05],[2005, 4.03837000000000E+05]] },{ "name":"Grenada", "category":"Grenada","x": [[2004, 9.60000000000000E+01]], "y": [[2004, 9.60000000000000E+01]], "size": [[2004, 1.02455000000000E+05]] },{ "name":"Venezuela, RB", "category":"Venezuela, RB","x": [[1981, 8.64893338185260E+01],[1990, 9.06725154008577E+01],[2001, 9.32574543750047E+01],[2007, 9.53817329708500E+01]], "y": [[1981, 8.30046639334158E+01],[1990, 8.90048547042946E+01],[2001, 9.27159786583056E+01],[2007, 9.49296433948037E+01]], "size": [[1981, 1.55702224000000E+07],[1990, 1.97500000000000E+07],[2001, 2.47650000000000E+07],[2007, 2.74830000000000E+07]] },{ "name":"Cambodia", "category":"Cambodia","x": [[1998, 7.94821791280993E+01],[2004, 8.46800143892625E+01],[2008, 8.50826722473369E+01]], "y": [[1998, 5.69925042589438E+01],[2004, 6.40509902069577E+01],[2008, 7.08581985278722E+01]], "size": [[1998, 1.19861280000000E+07],[2004, 1.31939610000000E+07],[2008, 1.38226440000000E+07]] },{ "name":"Trinidad and Tobago", "category":"Trinidad and Tobago","x": [[1980, 9.65215326625709E+01],[1990, 9.80097972180686E+01],[2004, 9.90000000000000E+01]], "y": [[1980, 9.34641652978300E+01],[1990, 9.56617941273830E+01],[2004, 9.78000000000000E+01]], "size": [[1980, 1.07820000000000E+06],[1990, 1.21549400000000E+06],[2004, 1.31062200000000E+06]] },{ "name":"Zambia", "category":"Zambia","x": [[1990, 7.30373392689642E+01],[1999, 7.62540227335644E+01],[2002, 8.09128630705394E+01]], "y": [[1990, 5.73577221193982E+01],[1999, 5.98028459088640E+01],[2002, 6.18392780403954E+01]], "size": [[1990, 7.86005300000000E+06],[1999, 9.94511500000000E+06],[2002, 1.06934710000000E+07]] },{ "name":"Singapore", "category":"Singapore","x": [[1980, 9.15662327264432E+01],[1990, 9.50931598608292E+01],[2000, 9.65650993406025E+01]], "y": [[1980, 7.39685367947783E+01],[1990, 8.30268481059213E+01],[2000, 8.86451751639692E+01]], "size": [[1980, 2.41400000000000E+06],[1990, 3.04700000000000E+06],[2000, 4.02790000000000E+06]] },{ "name":"Guinea-Bissau", "category":"Guinea-Bissau","x": [[1979, 3.33489454204827E+01],[2000, 5.76137538779731E+01]], "y": [[1979, 8.58826224717838E+00],[2000, 2.74942123249917E+01]], "size": [[1979, 8.09221000000000E+05],[2000, 1.24065500000000E+06]] },{ "name":"Dominican Republic", "category":"Dominican Republic","x": [[1981, 7.35902499556388E+01],[2002, 8.68110233399866E+01],[2007, 8.82101540770049E+01]], "y": [[1981, 7.25360846761177E+01],[2002, 8.71770931246018E+01],[2007, 8.82771710383024E+01]], "size": [[1981, 5.92842900000000E+06],[2002, 8.86076000000000E+06],[2007, 9.53195400000000E+06]] },{ "name":"Botswana", "category":"Botswana","x": [[1991, 6.53869379620127E+01],[2003, 8.04301079838343E+01]], "y": [[1991, 7.12992359222859E+01],[2003, 8.18079484097457E+01]], "size": [[1991, 1.42357000000000E+06],[2003, 1.83012700000000E+06]] },{ "name":"Kazakhstan", "category":"Kazakhstan","x": [[1989, 9.90719481596616E+01],[1999, 9.97632994292077E+01]], "y": [[1989, 9.61387710093713E+01],[1999, 9.92898953780488E+01]], "size": [[1989, 1.62495000000000E+07],[1999, 1.49284258540544E+07]] }];
yearMin=1975;
yearMax=2008;
xMin=9.38251300771484;
xMax=99.9989629520247;
yMin=3.18276569531967;
yMax=99.9976152595066;
sizeMin=12197.0;
sizeMax=1.262645E9;
xtitle = 'Percentage of Literate Males';
ytitle = 'Percentage of Literate Females'
width = 800;
height = 600
title = 'World Literacy (Population = Size)';
xaxisscale = 'Linear';
yaxisscale = 'Linear';
topMargin = 40;
bottomMargin = 40;
leftMargin = 140;
rightMargin = 40;
xFormat = ',d';
yFormat = ',d';


  document.title = title;
  document.getElementById('titletext').innerHTML = title;

  //var colorwheel = d3.select("radialGradient").id()

  readJson = function(text, callback)
  {
    callback(text ? JSON.parse(text) : null);
  }

  // Various accessors that specify the four dimensions of data to visualize.
  function x(d) { return d.x; }
  function y(d) { return d.y; }
  function radius(d) { return d.size; }
  function color(d) { return d.category; }
  function key(d) { return d.name; }

  // Various scales. These domains make assumptions of data, naturally.
  var xScale;

  if (xaxisscale == "Linear")
  {
    xScale = d3.scale.linear().domain([xMin, xMax]).range([0, width]);
  }
  else if (xaxisscale == "Square Root")
  {
    xScale = d3.scale.sqrt().domain([xMin, xMax]).range([0, width]);
  }
  else
  {
    //xScale = d3.scale.sqrt().domain([xMin, xMax]).range([0, width]);
    xScale = d3.scale.log().domain([xMin, xMax]).range([0, width]);
  }

  var yScale;

  if (yaxisscale == "Linear")
  {
    yScale = d3.scale.linear().domain([yMin, yMax]).range([height, 0]);
  }
  else if (yaxisscale == "Square Root")
  {
    yScale = d3.scale.sqrt().domain([yMin, yMax]).range([height, 0]);
  }
  else
  {
    yScale = d3.scale.log().domain([yMin, yMax]).range([height, 0]);
  }

var radiusScale = d3.scale.sqrt().domain([sizeMin, sizeMax]).range([1, 80]);
var colorScale = d3.scale.category20();

// The x & y axes.
var xAxis = d3.svg.axis().orient("bottom").scale(xScale).ticks(10, d3.format(xFormat));
var yAxis = d3.svg.axis().orient("left").scale(yScale).ticks(10, d3.format(yFormat));

//xAxis.append("g").attr("transform", "rotate(-90)")

// Create the SVG container and set the origin.
var svg = d3.select("#chart svg")
    .attr("width", width + leftMargin + rightMargin)
    .attr("height", height + topMargin + bottomMargin)
  .append("g")
    .attr("transform", "translate(" + leftMargin + "," + topMargin + ")");

// Add the x-axis.
svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

// Add the y-axis.
svg.append("g")
    .attr("class", "y axis")
    .call(yAxis);

// Add an x-axis label.
svg.append("text")
.style("font-size", "24px")
    .attr("class", "x label")
    .attr("text-anchor", "end")
    .attr("x", width)
    .attr("y", height - 6)
    .text(xtitle);

// Add a y-axis label.
svg.append("text")
.style("font-size", "24px")
    .attr("class", "y label")
    .attr("text-anchor", "end")
    .attr("y", 10)
    .attr("dy", ".75em")
    .attr("transform", "rotate(-90)")
    .text(ytitle);

  // Add the year label; the value is set on transition.
  var label = svg.append("text")
    .attr("class", "year label")
    .attr("text-anchor", "end")
    .attr("y", height - 30)
    .attr("x", width);

  // Load the data.
  readJson(JSON.stringify(jsonData), function(timedata) {

  // A bisector since some data is sparsely-defined.
  var bisect = d3.bisector(function(d) { return d[0]; });

  // Add a dot per nation. Initialize the data at 1800, and set the colors.
  var dot = svg.append("g")
      .attr("class", "dots")
    .selectAll(".dot")
    // Used to be 1800
      .data(interpolateData(0))
    .enter().append("circle")
      .attr("class", "dot")
      //.style("fill", function(d) { return colorScale(color(d)); })
      .style("opacity", 1)
      .style("fill", function (d) { return gradient(colorScale(color(d))) })
      .call(position)
      .sort(order)
      .on("mouseover", function()
      {
    	  d3.select(this).style("stroke-width", "5");
    	  var el = d3.select(this)
          var xpos = Number(el.attr('cx'))
          var ypos = (el.attr('cy') - d.radius - 10)
      })
      .on("mouseout", function(){d3.select(this).style("stroke-width", "1");});


//.on("mouseover", function(){d3.select(this).style("fill", "aliceblue");})
//.on("mouseout", function(){d3.select(this).style("fill", "white");})

  // Add a title.
  dot.append("title")
      .text(function(d) { return d.name + ":\n\n" + xtitle + "=" + d.x + "\n" + ytitle + "=" + d.y });

  // Start a transition that interpolates the data based on year.
  svg.transition()
      .duration(10000)
      .ease("linear")
      .tween("year", tweenYear)
      .each("end", enableInteraction);

  // Positions the dots based on data.
  function position(dot)
  {
    dot .attr("cx", function(d) { return xScale(x(d)); })
        .attr("cy", function(d) { return yScale(y(d)); })
        .attr("r", function(d) { return radiusScale(radius(d)); });
  }

  // Defines a sort order so that the smallest dots are drawn on top.
  function order(a, b)
  {
    return radius(b) - radius(a);
  }

  // After the transition finishes, you can mouseover to change the year.
  function enableInteraction()
  {
    var box = label.node().getBBox();

    var yearScale = d3.scale.linear()
        .domain([yearMin, yearMax])
        .range([box.x + 10, box.x + box.width - 10])
        .clamp(true);

    svg.append("rect")
        .attr("class", "overlay")
        .attr("x", box.x)
        .attr("y", box.y)
        .attr("width", box.width)
        .attr("height", box.height)
        .on("mouseover", mouseover)
        .on("mouseout", mouseout)
        .on("mousemove", mousemove)
        .on("touchmove", mousemove);

    function mouseover()
    {
      label.classed("active", true);
    }

    function mouseout()
    {
      label.classed("active", false);
    }

    function mousemove()
    {
      displayYear(yearScale.invert(d3.mouse(this)[0]));
    }
  }

  // Tweens the entire chart by first tweening the year, and then the data.
  // For the interpolated data, the dots and label are redrawn.
  function tweenYear() {
    var year = d3.interpolateNumber(yearMin, yearMax);
    return function(t) { displayYear(year(t)); };
  }

  // Updates the display to show the specified year.
  function displayYear(year)
  {
    dot.data(interpolateData(year), key).call(position).sort(order);
    dot.select("title")
      .text(function(d) { return d.name + ":\n\n" + xtitle + "=" + d.x + "\n" + ytitle + "=" + d.y });
    label.text(Math.round(year));
  }

  // Interpolates the dataset for the given (fractional) year.
  function interpolateData(year)
  {
    return timedata.map(function(d) {
      return {
        name: d.name,
        category: d.category,
        x: interpolateValues(d.x, year),
        size: interpolateValues(d.size, year),
        y: interpolateValues(d.y, year)
      };
    });
  }

  // Finds (and possibly interpolates) the value for the specified year.
  function interpolateValues(values, year) {
    var i = bisect.left(values, year, 0, values.length - 1),
        a = values[i];
    if (i > 0) {
      var b = values[i - 1],
          t = (year - a[0]) / (b[0] - a[0]);
      return a[1] * (1 - t) + b[1] * t;
    }
    return a[1];
  }
});
