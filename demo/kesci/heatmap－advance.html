<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
	<script src="http://libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
	<link href="http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
	<title>use heatmap</title>
	<script src = "../../../../lib/d3/d3.js"></script>
    <script src = "../../../../lib/queue/queue.js"></script>
    <script src = "../../../../lib/leaflet/leaflet.js"></script>
    <script src = "../../../../lib/leafletMarkerCluster/leaflet.markercluster-src.js"></script>
    <script src = "js/heatmap-nbremer/heatmap.js"></script>
    <script src = "js/heatmap-nbremer/heatmap-leaflet.js"></script>
    <script src = "js/heatmap-nbremer/QuadTree.js"></script>
    <link rel="stylesheet" href="../../../../lib/leaflet/leaflet.css">
    <link rel="stylesheet" href="../../../../lib/leafletMarkerCluster/MarkerCluster.Default.css">
    <link rel="stylesheet" href="../../../../lib/leafletMarkerCluster/MarkerCluster.css">
    <link rel="stylesheet" href="css/accidentMarkerCluster.css">
    <style media="screen">
        body {
        	margin: 0;
        	padding: 0;
        }
        #map {
            height: 700px;
        }
    </style>
</head>
<body>
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button class="navbar-toggle collapsed" tpye='button' data-toggle='collapse' data-target='#the-menu'>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a href="/index.html" class="navbar-brand brand">郭不耐</a>
			</div>
			<div class="collapse navbar-collapse" id='the-menu'>
				<ul class="nav navbar-nav navbar-right">
					<li><a href="index.html"><span class="glyphicon glyphicon-tasks"></span>&nbsp; Works</a></li>
					<li><a href="about.html"><span class="glyphicon glyphicon-user"></span>&nbsp; About</a></li>
				</ul>
			</div>
		</div>
	</nav>
	
	<div class="container-fluid">
		<div id="map"></div>
	</div>


		<div class="container">
			<div class='row'>

					<div class="panel panel-default">
						<div class="panel-body">panel-body</div>
					</div>

			</div>
		</div>

	<!-- =========================================================== -->
	<script type="text/javascript">
    var viewCenter = [31.213301496814,121.38761610866];
    var mapScale = 10;
    var maxZoom = 14;
    var mapStyle = 'http://{s}.tile.osm.org/{z}/{x}/{y}.png';
    var mapAttribution = '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors';

    // var map = L.map('map').setView(viewCenter, mapScale);
    // L.tileLayer(mapStyle, {attribution: mapAttribution,  maxZoom: maxZoom}).addTo(map);   

    d3.csv('data/geo_google_accident.csv', function(data) {
        // console.log(data);
        heatPoints = [];
        data.forEach(function(d) {
            d.lat = +d.lat;
            d.lng = +d.lng;
            heatPoints.push({d.lat, d.lng});
        });
        console.log(heatPoints);

        var heatmapLayer = L.TileLayer.heatMap({
            radius: {value: 12, absolute: false},
            visible: true,
            opacity: 60,
            gradient: {
                0.20: 'rgb(0, 0, 255)',
                0.45: 'rgb(0, 255, 255)',
                0.60: 'rgb(0, 255, 0)',
                0.75: 'yellow',
                0.95: 'rgb(255, 0, 0)'
            }
        });
        heatmapLayer.setData(heatPoints);

        var baseLayer = L.tileLayer(mapStyle, {attribution: mapAttribution});
        var map = new L.Map('map', {
            center: new L.LatLng(31.213301496814,121.38761610866),
            zoom: 14,
            layers: [baseLayer, heatmapLayer]
        });

            
    });

    
    </script>
</body>
</html>